# CineSRT Phase 3 개발 계획서
## Part 1: 개요 및 현황 분석

### 1. 프로젝트 개요

#### 1.1 Phase 3 목표
**언리얼 엔진의 실시간 영상을 H.264로 인코딩하여 OBS/VLC 등 표준 방송 소프트웨어에서 수신 가능한 상용 스트리밍 시스템 구축**

#### 1.2 핵심 변경사항
- **현재**: Raw BGRA 픽셀 전송 (8MB/frame, 240MB/s)
- **목표**: H.264 압축 스트림 (150KB/frame, 5Mbps)
- **결과**: 50배 대역폭 절감, 표준 호환성 확보

### 2. 현황 분석

#### 2.1 완료된 작업 (Phase 2 성과)
✅ **SRT 프로토콜 통합 완료**
- Windows 환경에서 안정적인 SRT 통신
- 실시간 30fps 데이터 전송 검증
- 연결 관리 및 에러 처리 구현

✅ **프레임 캡처 시스템**
- Scene Capture Component 활용
- GPU → CPU 메모리 전송 구현
- 프레임 버퍼 관리 시스템

✅ **멀티스레드 아키텍처**
- 메인 스레드와 워커 스레드 분리
- 안정적인 스레드 동기화
- 비동기 처리 구조

#### 2.2 현재 시스템의 한계
❌ **호환성 문제**
- OBS/VLC에서 인식 불가 (커스텀 포맷)
- receiver.exe로만 수신 가능

❌ **비현실적인 대역폭**
- 1080p 30fps = 240MB/s (1.9Gbps)
- 네트워크 포화 상태 유발

❌ **상용화 불가**
- 표준 미준수
- 압축 없음
- 확장성 부족

### 3. Phase 3 기술 요구사항

#### 3.1 필수 구현 사항
1. **H.264 실시간 인코딩**
   - Baseline/Main Profile
   - 5-10 Mbps 비트레이트
   - 최대 100ms 인코딩 지연

2. **MPEG-TS 멀티플렉싱**
   - ISO/IEC 13818-1 표준 준수
   - 정확한 PTS/DTS 타임스탬프
   - PAT/PMT 테이블 생성

3. **OBS 완벽 호환**
   - SRT Input Source 인식
   - 메타데이터 포함
   - 에러 없는 연속 재생

#### 3.2 성능 목표
- **CPU 사용률**: 30% 이하 (i7 기준)
- **메모리 사용**: 500MB 이하
- **지연시간**: End-to-end 200ms 이하
- **안정성**: 24시간 연속 운영

### 4. 기술 스택

#### 4.1 인코딩 라이브러리
**FFmpeg 통합**
- 라이선스: LGPL (동적 링크)
- 버전: 6.0 이상
- 필수 라이브러리:
  - libavcodec (H.264 인코딩)
  - libavformat (MPEG-TS 멀티플렉싱)
  - libswscale (색공간 변환)

#### 4.2 하드웨어 가속 (선택사항)
- NVIDIA NVENC
- Intel Quick Sync
- AMD VCE

### 5. 리스크 분석

#### 5.1 기술적 리스크
| 리스크 | 확률 | 영향도 | 대응 방안 |
|--------|------|--------|-----------|
| FFmpeg 통합 실패 | 낮음 | 높음 | x264 직접 사용 |
| OBS 호환성 문제 | 중간 | 중간 | 패킷 분석 및 조정 |
| 성능 목표 미달 | 중간 | 높음 | 하드웨어 인코더 사용 |
| 타이밍 동기화 | 높음 | 중간 | PTS 계산 로직 정교화 |

#### 5.2 일정 리스크
- 예상 기간: 4-6주
- 버퍼 기간: 2주 추가
- 주요 마일스톤별 검증 필수

### 6. 성공 기준

#### 6.1 기능적 성공 기준
- [ ] OBS Media Source로 스트림 수신
- [ ] 30분 이상 끊김 없는 재생
- [ ] 영상/음성 동기화 (향후)
- [ ] 다중 해상도 지원

#### 6.2 비기능적 성공 기준
- [ ] 초당 프레임 드롭 0.1% 이하
- [ ] 메모리 누수 없음
- [ ] 네트워크 재연결 자동 복구
- [ ] 사용자 친화적 에러 메시지

### 7. 팀 구성 및 역할

**개발팀**
- 코어 개발자: FFmpeg 통합, 인코딩 파이프라인
- 테스트 엔지니어: OBS 호환성 검증, 성능 테스트
- DevOps: 빌드 시스템, CI/CD 구축

**필요 전문성**
- 비디오 코덱 경험
- 실시간 시스템 개발
- 네트워크 프로그래밍

---

다음 문서: Part 2 - 기술 아키텍처 설계